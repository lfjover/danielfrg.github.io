<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Daniel Rodriguez">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Django + Celery + Readability = Python relevant content crawler | Daniel Rodriguez</title>

        <link rel="alternate" type="application/atom+xml" title="Daniel Rodriguez blog atom feed" href="/feeds/all.atom.xml" />
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
        <link rel="stylesheet" href="/theme/css/pygments.css">
        <link rel="stylesheet" href="/theme/css/main.css">

    </head>

    <body>
        <header class="main-header" style="background: url('/images/station1.jpg') no-repeat center center #DDD; background-size: 100%;">
        <nav>
            <div class="container">
            <ul>
                <li><a href="/" title="Home">Home</a></li>

                    <li><a href="/pages/about.html" title="About">About</a></li>
                    <li><a href="http://github.com/danielfrg" title="danielfrg's Github" rel="me">Github</a></li>
                    <li><a href="http://twitter.com/danielfrg" title="danielfrg Twitter" rel="me">Twitter</a></li>
                    <li><a href="/archives.html" title="Archive">Archives</a></li>
                    <li><a href="/feeds/all.atom.xml" title="danielfrg.github.io RSS feed" rel="me">RSS</a></li>
            </ul>
            </div>
        </nav>
        </header>

<div class="container post">

    <article>
        <header>
            <h1>Django + Celery + Readability = Python relevant content crawler</h1>
            <time datetime="article.date.isoformat()" pubdate>September 11, 2013</time>
        </header>

        <div class="article_content">
            <p>I have written a <a href="/blog/2013/08/20/relevant-content-blog-crawler/">few</a> <a href="/blog/2013/04/01/nba-scraping-data/">posts</a>
about crawling content from the web. Mainly because I know the power of data
and the biggest data source in the world is the web, Google knew it and we all now how they are
doing. In my <a href="/blog/2013/08/20/relevant-content-blog-crawler/">last post</a> I wrote about crawling relevant content
from blogs; It worked but what if I want an admin UI to control the crawling. What if I just put
the crawler in an EC2 instance and just call it when I need to crawl.</p>
<p>The solution was pretty simple thanks to some python projects.
I just needed to move from <a href="http://www.sqlalchemy.org/">sqlalchemy</a> to
<a href="https://docs.djangoproject.com/en/1.5/">django</a> ORM, create a few <a href="http://celeryproject.org/">celery</a> tasks
and use <a href="https://github.com/celery/django-celery/">django-celery</a> to have a pretty UI of the tasks.</p>
<p>I was amazed on how easy it was to integrate celery with django. I just created a few tasks to
actually crawl blogs (I already had the code from my last post) and create some
<a href="https://docs.djangoproject.com/en/dev/ref/contrib/admin/actions/">django actions</a> so the I can create
tasks by demand.</p>
<h2>Tasks</h2>
<p>The <code>tasks.py</code> is below. Depending on if the blog is wordpress or blogspot I crawl the blog feed
differently, that way I can crawl not only the 10 most recent posts but the whole blog. So I created a few tasks
to discover the type of the blog. Then based on the type discover the feed URL to crawl.</p>
<p>For example wordpress blogs generally have the feed under: <code>http://mywordpressblog.com/feed/</code>.
This gives me only 10 posts if I want more I can request: <code>http://mywordpressblog.com/feed/?paged=2</code>
and that will give me a feed from post 11 to 20. Do this recursively and you get all the posts of the blog.
Something similar happens with blogspot.</p>
<p>Finally I created some simple tasks to convert the post content to lower-case and word-tokenization using
a new but pretty amazing library called <a href="https://github.com/sloria/TextBlob">TextBlob</a></p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">task</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">apps.blog_crawler</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">apps.blog_crawler.models</span> <span class="kn">import</span> <span class="n">Blog</span><span class="p">,</span> <span class="n">Post</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">readability</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">text.blob</span> <span class="kn">import</span> <span class="n">TextBlob</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">lowerize</span><span class="p">(</span><span class="n">post_id</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">post_id</span><span class="p">)</span>

    <span class="n">post</span><span class="o">.</span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">cleaned</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">word_tokenize</span><span class="p">(</span><span class="n">post_id</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">post_id</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">post</span><span class="o">.</span><span class="n">cleaned</span><span class="p">)</span>

    <span class="n">post</span><span class="o">.</span><span class="n">cleaned</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">words</span><span class="p">)</span>
    <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">discover_type</span><span class="p">(</span><span class="n">blog_id</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">blog_id</span><span class="p">)</span>

    <span class="n">kind</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">discover_kind</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">discover_feed</span><span class="p">(</span><span class="n">blog_id</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">blog_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">blog</span><span class="o">.</span><span class="n">kind</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kind</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">discover_kind</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="n">blog</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span>
    <span class="n">feed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">discover_feed</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">blog</span><span class="o">.</span><span class="n">kind</span><span class="p">)</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">feed</span> <span class="o">=</span> <span class="n">feed</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">crawl</span><span class="p">(</span><span class="n">blog_id</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">blog_id</span><span class="p">)</span>

    <span class="c"># Readability API</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">readability</span><span class="o">.</span><span class="n">ParserClient</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">READABILITY_PARSER_TOKEN</span><span class="p">)</span>

    <span class="c"># Create and start logger</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">create_logger</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">))</span>

    <span class="n">post_list</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_posts</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">feed</span><span class="p">,</span> <span class="n">blog</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
    <span class="n">n_posts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">post_list</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;{0} ({1})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">n_posts</span><span class="p">))</span>

    <span class="c"># Start actual crawl</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">post_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;{0}/{1} Already exists: {2}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n_posts</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parser_response</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_article_content</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">parser_response</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s">&#39;content&#39;</span><span class="p">])</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">)</span>
                <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;{0}/{1} FAIL: {2}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_posts</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;{0}/{1} OK: {2}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_posts</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.6</span><span class="p">)</span>
</pre></div>


<h2>Django Admin</h2>
<p>Then just needed to create a django app with some actions to call the celery tasks. This allows me to have the
worker on a micro instance on EC2 and just queue the tasks using celery.
I used <a href="http://www.rabbitmq.com/">rabbitmq</a> as the broker.</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">Blog</span><span class="p">,</span> <span class="n">Post</span>
<span class="kn">from</span> <span class="nn">apps.blog_crawler</span> <span class="kn">import</span> <span class="n">tasks</span>


<span class="k">class</span> <span class="nc">BlogAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">,</span> <span class="s">&#39;kind&#39;</span><span class="p">,</span> <span class="s">&#39;feed&#39;</span><span class="p">,</span> <span class="s">&#39;last_crawl&#39;</span><span class="p">]</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;discover_type&#39;</span><span class="p">,</span> <span class="s">&#39;discover_feed&#39;</span><span class="p">,</span> <span class="s">&#39;crawl&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">discover_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">blog</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
            <span class="n">tasks</span><span class="o">.</span><span class="n">discover_type</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_user</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;Task(s) created&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">discover_feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">blog</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
            <span class="n">tasks</span><span class="o">.</span><span class="n">discover_feed</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_user</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;Task(s) created&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">crawl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">blog</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
            <span class="n">tasks</span><span class="o">.</span><span class="n">crawl</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">blog</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_user</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;Task(s) created&#39;</span><span class="p">)</span>

    <span class="n">discover_type</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Discover the type of the blog(s)&#39;</span>
    <span class="n">discover_feed</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Discover the feed of the blog(s)&#39;</span>
    <span class="n">crawl</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Crawls the selected blog(s)&#39;</span>


<span class="k">class</span> <span class="nc">PostAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">,</span> <span class="s">&#39;date&#39;</span><span class="p">]</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;copy&#39;</span><span class="p">,</span> <span class="s">&#39;word_tokenize&#39;</span><span class="p">,</span> <span class="s">&#39;lowerize&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
            <span class="n">post</span><span class="o">.</span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">content</span>
            <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_user</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;Content copied&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">word_tokenize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
            <span class="n">tasks</span><span class="o">.</span><span class="n">word_tokenize</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">post</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_user</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;Task(s) created&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">lowerize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">:</span>
            <span class="n">tasks</span><span class="o">.</span><span class="n">lowerize</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">post</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_user</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;Task(s) created&#39;</span><span class="p">)</span>

    <span class="n">copy</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Copy the crawled content to cleaned&#39;</span>
    <span class="n">word_tokenize</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Tockenize by words&#39;</span>
    <span class="n">lowerize</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Lower-case the cleaned content&#39;</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Blog</span><span class="p">,</span> <span class="n">BlogAdmin</span><span class="p">)</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span> <span class="n">PostAdmin</span><span class="p">)</span>
</pre></div>


<h2>UI</h2>
<p>The admin UI, using the <a href="http://djangosuit.com/">beautiful django suit</a>, looks like this.</p>
<p><img alt="Home admin UI" src="/images/blog/2013/09/django-crawler/home_admin.png" title="Home admin UI" /></p>
<p>Note: don't ask me why is I am using that blog to test</p>
<p><img alt="Blog admin UI" src="/images/blog/2013/09/django-crawler/blogs_admin.png" title="Blogs admin UI" /></p>
<p><img alt="Posts admin UI" src="/images/blog/2013/09/django-crawler/posts_admin.png" title="Posts admin UI" /></p>
<p>You can see the running tasks, or previous tasks.</p>
<p><img alt="Tasks admin UI" src="/images/blog/2013/09/django-crawler/tasks.png" title="Tasks admin UI" /></p>
<h2>Conclusion</h2>
<p>I was pretty happy with this result. With very little effort I was able to build a quite complex
system. PostgreSQL for the database, rabbitmq + celery for message/tasks queuing and finally
Django for the UI. I can even create some</p>
<p>I consider this an example of why I choose python and its amazing community. The people working on
these projects are brilliant and are doing an amazing job. Focusing on building the basic tools so
people can build amazing stuff faster and easier than ever.</p>
<p>Some stuff I want to try next if real live allows me to is:</p>
<ul>
<li><a href="http://haystacksearch.org/">Haystack</a> + Solr for search</li>
<li>MongoDB instead of Postgres. Apparently is <em>really</em> easy using <a href="https://github.com/django-nonrel/mongodb-engine">django-nonrel</a></li>
</ul>
<p>As usual everything is on github: <a href="https://github.com/danielfrg/django_crawler">django-crawler</a></p>
        </div>

        <div class="meta">
            <div>
                    <a href="/tag/python.html" class="tag">python</a>
                    <a href="/tag/django.html" class="tag">django</a>
                    <a href="/tag/celery.html" class="tag">celery</a>
                    <a href="/tag/readability.html" class="tag">readability</a>
                    <a href="/tag/crawling.html" class="tag">crawling</a>
            </div>
            <div>
                <a id="comments-button" class="comments_btn" href="#disqus_thread">Show comments</a>
            </div>
        </div>
    </article>
</div>

<script type="text/javascript">
(function () {
    'use strict';

    // Global object
    var App = {};

    // Create button
    App.commentsButton = document.getElementById('comments-button');

    App.commentsButton.onclick = function () {
        // Remove button action on click
        App.commentsButton.onclick = function () {
        }

        // Create comments container
        App.disqusContainer = document.createElement('div');
        App.disqusContainer.setAttribute('id', 'disqus_thread');
        // App.disqusContainer.setAttribute('class', 'container');

        // Append container to body or div
        // document.body.appendChild( App.disqusContainer );
        var container = document.getElementsByClassName('container post')[0];
        container.appendChild(App.disqusContainer);

        // Your Disqus shortname
        App.disqus_shortname = 'danielfrg';

        // Embed Disqus
        var dsq = document.createElement('script');

        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + App.disqus_shortname + '.disqus.com/embed.js';

        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

        window.scrollTo(0, dsq.offsetTop - 200);
    };
})();
</script>



<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-35523657-2']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

    </body>
</html>